{
  "id": "00000000-0000-0000-0000-000000000000",
  "revision": 0,
  "last_node_id": 175,
  "last_link_id": 14,
  "nodes": [
    {
      "id": 172,
      "type": "PyIsolatedExecuteAdvancedV3",
      "pos": [
        180,
        -42.66668701171875
      ],
      "size": [
        614.0000000000001,
        426.66668701171875
      ],
      "flags": {},
      "order": 3,
      "mode": 0,
      "inputs": [
        {
          "name": "image_payload",
          "shape": 7,
          "type": "IMAGE",
          "link": null
        },
        {
          "name": "latent_payload",
          "shape": 7,
          "type": "LATENT",
          "link": null
        },
        {
          "name": "mask_payload",
          "shape": 7,
          "type": "MASK",
          "link": null
        },
        {
          "name": "text_payload",
          "shape": 7,
          "type": "STRING",
          "widget": {
            "name": "text_payload"
          },
          "link": 13
        }
      ],
      "outputs": [
        {
          "name": "result_text",
          "type": "STRING",
          "links": [
            8,
            9
          ]
        },
        {
          "name": "result_image",
          "type": "IMAGE",
          "links": null
        },
        {
          "name": "result_latent",
          "type": "LATENT",
          "links": null
        },
        {
          "name": "stdout",
          "type": "STRING",
          "links": null
        },
        {
          "name": "exit_code",
          "type": "INT",
          "links": null
        }
      ],
      "properties": {
        "Node name for S&R": "PyIsolatedExecuteAdvancedV3"
      },
      "widgets_values": [
        "# PyIsolated demo: synthetic social graph + validation + ranking\nfrom io import StringIO\nfrom faker import Faker\nfrom slugify import slugify\nimport numpy as np\nimport pandas as pd\nimport networkx as nx\nfrom pydantic import BaseModel, ValidationError\nimport humanize\nfrom tabulate import tabulate\nimport more_itertools as mit\nfrom rich.console import Console\nfrom rich.table import Table\nfrom datetime import datetime, timedelta\nimport random\n\n# Inputs from node\nscenario = text_payload or \"Demo\"\n\nrng = random.Random(42)\nfaker = Faker()\nfaker.seed_instance(42)\n\nclass User(BaseModel):\n    name: str\n    handle: str\n    followers: int\n    messages: int\n\n# Generate fake users\nusers = []\nfor _ in range(8):\n    name = faker.name()\n    handle = slugify(name)\n    followers = rng.randint(50, 5000)\n    messages = rng.randint(5, 120)\n    users.append({\"name\": name, \"handle\": handle, \"followers\": followers, \"messages\": messages})\n\n# Validate with pydantic\nvalidated = []\nfor u in users:\n    try:\n        validated.append(User(**u))\n    except ValidationError as e:\n        print(\"Validation error:\", e)\n\ndf = pd.DataFrame([u.dict() for u in validated])\ndf[\"msg_rate\"] = df[\"messages\"] / (df[\"followers\"] + 1)\ndf[\"score\"] = 0.7 * df[\"followers\"] + 0.3 * df[\"messages\"]\n\n# Build interaction graph (simple windowed chain)\nG = nx.DiGraph()\nfor u in validated:\n    G.add_node(u.handle, followers=u.followers, messages=u.messages)\nfor a, b in mit.windowed([u.handle for u in validated], 2):\n    if b is None:\n        continue\n    weight = rng.randint(1, 10)\n    G.add_edge(a, b, weight=weight)\npagerank = nx.pagerank(G, weight=\"weight\")\n\n# Top scores\ndf[\"pagerank\"] = df[\"handle\"].map(pagerank)\ntop = df.sort_values(by=[\"pagerank\"], ascending=False).head(5)\n\n# Rich table\nconsole_stream = StringIO()\nconsole = Console(file=console_stream, width=100, color_system=None)\ntable = Table(title=f\"PyIsolated Demo â€“ {scenario}\")\ntable.add_column(\"handle\")\ntable.add_column(\"followers\", justify=\"right\")\ntable.add_column(\"messages\", justify=\"right\")\ntable.add_column(\"pagerank\", justify=\"right\")\nfor _, row in top.iterrows():\n    table.add_row(\n        row[\"handle\"],\n        f\"{row['followers']}\",\n        f\"{row['messages']}\",\n        f\"{row['pagerank']:.4f}\",\n    )\nconsole.print(table)\n\n# Tabulate summary\nsummary = tabulate(\n    df[[\"handle\", \"followers\", \"messages\", \"msg_rate\"]].head(5),\n    headers=\"keys\",\n    tablefmt=\"github\",\n    floatfmt=\".4f\",\n)\n\nelapsed = humanize.naturaldelta(timedelta(seconds=3.14))\n\nresult = \"\\n\".join(\n    [\n        f\"Scenario: {scenario}\",\n        f\"Users: {len(df)}\",\n        f\"Graph nodes/edges: {G.number_of_nodes()}/{G.number_of_edges()}\",\n        f\"Elapsed (fake): {elapsed}\",\n        \"\",\n        \"Top PageRank (rich table):\",\n        console_stream.getvalue().strip(),\n        \"\",\n        \"Sample metrics (tabulate):\",\n        summary,\n        \"\",\n        \"Notes: score = 0.7*followers + 0.3*messages; msg_rate = messages/(followers+1)\",\n    ]\n)\n\nprint(result)  # captured to stdout",
        "",
        "Faker\npython-slugify\nnumpy\npandas\nnetworkx\npydantic\nhumanize\ntabulate\nmore-itertools\nrich"
      ]
    },
    {
      "id": 171,
      "type": "LoadImage",
      "pos": [
        -286.2000695800782,
        628.1399652099611
      ],
      "size": [
        274.080078125,
        314
      ],
      "flags": {},
      "order": 0,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "IMAGE",
          "type": "IMAGE",
          "links": [
            10
          ]
        },
        {
          "name": "MASK",
          "type": "MASK",
          "links": null
        }
      ],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.76",
        "Node name for S&R": "LoadImage"
      },
      "widgets_values": [
        "ComfyUI_00004_.png",
        "image"
      ]
    },
    {
      "id": 166,
      "type": "PyIsolatedExecuteV3",
      "pos": [
        241.35324340820318,
        619.3133435058594
      ],
      "size": [
        562.1733740234374,
        326.00006103515625
      ],
      "flags": {},
      "order": 2,
      "mode": 0,
      "inputs": [
        {
          "name": "image_payload",
          "shape": 7,
          "type": "IMAGE",
          "link": 10
        },
        {
          "name": "latent_payload",
          "shape": 7,
          "type": "LATENT",
          "link": null
        },
        {
          "name": "mask_payload",
          "shape": 7,
          "type": "MASK",
          "link": null
        }
      ],
      "outputs": [
        {
          "name": "result_text",
          "type": "STRING",
          "links": [
            11,
            12
          ]
        },
        {
          "name": "result_image",
          "type": "IMAGE",
          "links": [
            14
          ]
        },
        {
          "name": "result_latent",
          "type": "LATENT",
          "links": null
        },
        {
          "name": "stdout",
          "type": "STRING",
          "links": null
        },
        {
          "name": "exit_code",
          "type": "INT",
          "links": null
        }
      ],
      "properties": {
        "Node name for S&R": "PyIsolatedExecuteV3"
      },
      "widgets_values": [
        "# Invert the image colors\nimport torch\n\n# image_payload is a torch tensor with shape [B, H, W, C]\nif image_payload is not None:\n    inverted = 1.0 - image_payload\n    result = {\"result_text\": f\"Inverted image shape: {inverted.shape}\", \"result_image\": inverted}\nelse:\n    result = {\"result_text\": \"No image provided\", \"result_image\": None}",
        "World"
      ]
    },
    {
      "id": 157,
      "type": "Show any [Crystools]",
      "pos": [
        919.3733654785157,
        -247.3866586303711
      ],
      "size": [
        803.2850708007812,
        501.3200738525391
      ],
      "flags": {},
      "order": 7,
      "mode": 0,
      "inputs": [
        {
          "name": "any_value",
          "shape": 7,
          "type": "*",
          "link": 8
        }
      ],
      "outputs": [],
      "properties": {
        "cnr_id": "comfyui-crystools",
        "ver": "1.27.4",
        "Node name for S&R": "Show any [Crystools]"
      }
    },
    {
      "id": 164,
      "type": "SaveStringKJ",
      "pos": [
        452.20000854492207,
        -248.78676086425773
      ],
      "size": [
        270,
        106
      ],
      "flags": {},
      "order": 8,
      "mode": 0,
      "inputs": [
        {
          "name": "string",
          "type": "STRING",
          "link": 9
        }
      ],
      "outputs": [
        {
          "name": "filename",
          "type": "STRING",
          "links": null
        }
      ],
      "properties": {
        "cnr_id": "comfyui-kjnodes",
        "ver": "1.1.9",
        "Node name for S&R": "SaveStringKJ"
      },
      "widgets_values": [
        "PyIsolatedExecuteAdvancedV3",
        "output",
        ".txt"
      ]
    },
    {
      "id": 167,
      "type": "SaveStringKJ",
      "pos": [
        252.193382568359,
        1102.9400000000003
      ],
      "size": [
        270,
        106
      ],
      "flags": {},
      "order": 4,
      "mode": 0,
      "inputs": [
        {
          "name": "string",
          "type": "STRING",
          "link": 11
        }
      ],
      "outputs": [
        {
          "name": "filename",
          "type": "STRING",
          "links": null
        }
      ],
      "properties": {
        "cnr_id": "comfyui-kjnodes",
        "ver": "1.1.9",
        "Node name for S&R": "SaveStringKJ"
      },
      "widgets_values": [
        "PyIsolatedExecuteV3",
        "output",
        ".txt"
      ]
    },
    {
      "id": 168,
      "type": "Show any [Crystools]",
      "pos": [
        1001.5867651367188,
        433.86000000000007
      ],
      "size": [
        458.0318359375,
        160
      ],
      "flags": {},
      "order": 5,
      "mode": 0,
      "inputs": [
        {
          "name": "any_value",
          "shape": 7,
          "type": "*",
          "link": 12
        }
      ],
      "outputs": [],
      "properties": {
        "cnr_id": "comfyui-crystools",
        "ver": "1.27.4",
        "Node name for S&R": "Show any [Crystools]"
      }
    },
    {
      "id": 173,
      "type": "SaveImage",
      "pos": [
        1104.8400000000001,
        813.4466912841797
      ],
      "size": [
        270,
        270
      ],
      "flags": {},
      "order": 6,
      "mode": 0,
      "inputs": [
        {
          "name": "images",
          "type": "IMAGE",
          "link": 14
        }
      ],
      "outputs": [],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.76"
      },
      "widgets_values": [
        "PyIsolatedExecuteAdvancedV1"
      ]
    },
    {
      "id": 159,
      "type": "PyIsolatedTestNodeV3",
      "pos": [
        -193.34,
        233.0466870117188
      ],
      "size": [
        181.540625,
        26
      ],
      "flags": {},
      "order": 1,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "message",
          "type": "STRING",
          "links": [
            13
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "PyIsolatedTestNodeV3"
      }
    }
  ],
  "links": [
    [
      8,
      172,
      0,
      157,
      0,
      "*"
    ],
    [
      9,
      172,
      0,
      164,
      0,
      "STRING"
    ],
    [
      10,
      171,
      0,
      166,
      0,
      "IMAGE"
    ],
    [
      11,
      166,
      0,
      167,
      0,
      "STRING"
    ],
    [
      12,
      166,
      0,
      168,
      0,
      "*"
    ],
    [
      13,
      159,
      0,
      172,
      3,
      "STRING"
    ],
    [
      14,
      166,
      1,
      173,
      0,
      "IMAGE"
    ]
  ],
  "groups": [],
  "config": {},
  "extra": {
    "ds": {
      "scale": 0.6830134553650706,
      "offset": [
        730.5914868023222,
        585.2198376792334
      ]
    },
    "frontendVersion": "1.33.10",
    "VHS_latentpreview": false,
    "VHS_latentpreviewrate": 0,
    "VHS_MetadataImage": true,
    "VHS_KeepIntermediate": true
  },
  "version": 0.4
}